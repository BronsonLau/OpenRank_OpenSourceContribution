<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenDigger可视化大屏</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
</head>
<body>
    <div class="dashboard">
        <header>
            <div class="header-left">
                <div class="author-info">
                    <div>作者: key</div>
                    <div>华东师范大学数据科学与工程学院</div>
                </div>
                <h1>仓库以及个人操作数据展示可视化大屏</h1>
            </div>
            <div class="header-right">
                <div class="repo-name" id="repo-name">ant-design/ant-design</div>
            </div>
        </header>

        <main>
            <div class="left-column">
                <div class="card">
                    <h2>仓库统计</h2>
                    <div class="metrics-overview">
                        <div class="metric-card">
                            <h3>总贡献者</h3>
                            <p>200</p>
                        </div>
                        <div class="metric-card">
                            <h3>星标数</h3>
                            <p>15000</p>
                        </div>
                        <div class="metric-card">
                            <h3>Fork 数</h3>
                            <p>500</p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <h2>贡献者表格</h2>
                    <div class="scrolling-table-container">
                        <div class="scrolling-table-wrapper">
                            <table id="contributor-table">
                                <thead>
                                    <tr>
                                        <th>用户名</th>
                                        <th>贡献数</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>张三</td>
                                        <td>50</td>
                                    </tr>
                                    <tr>
                                        <td>李四</td>
                                        <td>30</td>
                                    </tr>
                                    <tr>
                                        <td>王五</td>
                                        <td>45</td>
                                    </tr>
                                    <tr>
                                        <td>赵六</td>
                                        <td>60</td>
                                    </tr>
                                    <tr>
                                        <td>钱七</td>
                                        <td>25</td>
                                    </tr>
                                    <tr>
                                        <td>孙八</td>
                                        <td>80</td>
                                    </tr>
                                    <tr>
                                        <td>周九</td>
                                        <td>40</td>
                                    </tr>
                                    <tr>
                                        <td>吴十</td>
                                        <td>35</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            
                <!-- 图表容器 -->
                <div class="charts-container">
                    <div class="card">
                        <h2>贡献者活动柱状图</h2>
                        <canvas id="contributorActivityChart"></canvas>
                    </div>
            
                    <div class="card">
                        <h2>仓库Fork数变化柱状图</h2>
                        <canvas id="forksChangeChart"></canvas>
                    </div>
                </div>
            </div>
            

            <div class="right-column">
                <div class="chart-container">
                    <div class="search-container">
                        <select id="dataTypeSelector" class="data-type-select" onchange="updateChartTitle()">
                            <option value="openrank">OpenRank</option>
                            <option value="activity">活跃度</option>
                            <option value="attention">关注度</option>
                            <option value="stars">星标数据</option>
                            <option value="technical_fork">技术分支</option>
                            <option value="participants">参与者</option>
                            <option value="new_contributors">新贡献者</option>
                            <option value="inactive_contributors">非活跃贡献者</option>
                            <option value="bus_factor">巴士因子</option>
                            <option value="issues_new">新议题</option>
                            <option value="issues_closed">已关闭议题</option>
                            <option value="issue_comments">议题评论</option>
                            <option value="code_change_lines_add">代码增加行数</option>
                            <option value="code_change_lines_remove">代码删除行数</option>
                            <option value="code_change_lines_sum">代码变更总行数</option>
                            <option value="change_requests">变更请求</option>
                            <option value="change_requests_accepted">已接受的变更请求</option>
                            <option value="change_requests_reviews">变更请求审查</option>
                        </select>
                        <input type="text" placeholder="Enter GitHub repo (e.g. X-lab2017/open-digger)" id="repoInput">
                        <button id="search-button" onclick="fetchData()">搜索</button>
                    </div>

                    <h2 id="chartTitle" style="text-align: center;">GitHub OpenRank Chart</h2>
                    <div id="error"></div>

                    <div class="chart-selector">
                        <button class="chart-button active" data-chart="year">年度图表</button>
                        <button class="chart-button" data-chart="month">月度图表</button>
                        <button class="chart-button" data-chart="quarter">季度图表</button>
                    </div>

                    <canvas id="openRankChart"></canvas>
                </div>

                <div class="chart-container">
                    <div class="search-container">
                        <select id="dataTypeSelector2" class="data-type-select" onchange="updateSecondChartTitle()">
                            <option value="openrank">OpenRank</option>
                            <option value="activity">活跃度</option>
                        </select>
                        <input type="text" placeholder="Enter GitHub username (e.g. frank-zsy)" id="userInput">
                        <button id="search-button2" onclick="fetchUserData()">搜索</button>
                    </div>

                    <h2 id="chartTitle2" style="text-align: center;">GitHub User OpenRank Chart</h2>
                    <div id="error2"></div>

                    <div class="chart-selector">
                        <button class="chart-button active" data-chart="year" onclick="updateSecondChart('year')">年度图表</button>
                        <button class="chart-button" data-chart="month" onclick="updateSecondChart('month')">月度图表</button>
                        <button class="chart-button" data-chart="quarter" onclick="updateSecondChart('quarter')">季度图表</button>
                    </div>

                    <canvas id="userChart"></canvas>
                </div>
            </div>
        </main>
    </div>

    <script src="script.js"></script>
</body>
</html>
